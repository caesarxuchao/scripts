set -o errexit
set -o nounset
set -o pipefail

# get the type: git grep "type" types.go | grep ":type" | awk '{print $2}'
# git grep "string" annotation_key_constants.go | awk '{print $2}'
# git grep "Key =" types.go | awk '{print $2}'
# git grep "func" defaults.go | awk '{print $2}' | awk -F "(" '{print $1}'
# use tagbar to get all the constants

types="ObjectMeta
Volume
VolumeSource
PersistentVolumeClaimVolumeSource
PersistentVolumeSource
PersistentVolume
PersistentVolumeSpec
PersistentVolumeReclaimPolicy
PersistentVolumeStatus
PersistentVolumeList
PersistentVolumeClaim
PersistentVolumeClaimList
PersistentVolumeClaimSpec
PersistentVolumeClaimStatus
PersistentVolumeAccessMode
PersistentVolumePhase
PersistentVolumeClaimPhase
HostPathVolumeSource
EmptyDirVolumeSource
GlusterfsVolumeSource
RBDVolumeSource
CinderVolumeSource
CephFSVolumeSource
FlockerVolumeSource
StorageMedium
Protocol
GCEPersistentDiskVolumeSource
QuobyteVolumeSource
FlexVolumeSource
AWSElasticBlockStoreVolumeSource
GitRepoVolumeSource
SecretVolumeSource
SecretProjection
NFSVolumeSource
ISCSIVolumeSource
FCVolumeSource
AzureFileVolumeSource
VsphereVirtualDiskVolumeSource
PhotonPersistentDiskVolumeSource
AzureDataDiskCachingMode
AzureDiskVolumeSource
PortworxVolumeSource
ScaleIOVolumeSource
ConfigMapVolumeSource
ConfigMapProjection
ProjectedVolumeSource
VolumeProjection
KeyToPath
ContainerPort
VolumeMount
EnvVar
EnvVarSource
ObjectFieldSelector
ResourceFieldSelector
ConfigMapKeySelector
SecretKeySelector
EnvFromSource
ConfigMapEnvSource
SecretEnvSource
HTTPHeader
HTTPGetAction
URIScheme
TCPSocketAction
ExecAction
Probe
PullPolicy
TerminationMessagePolicy
Capability
Capabilities
ResourceRequirements
Container
Handler
Lifecycle
ConditionStatus
ContainerStateWaiting
ContainerStateRunning
ContainerStateTerminated
ContainerState
ContainerStatus
PodPhase
PodConditionType
PodCondition
RestartPolicy
DNSPolicy
NodeSelector
NodeSelectorTerm
NodeSelectorRequirement
NodeSelectorOperator
Affinity
PodAffinity
PodAntiAffinity
WeightedPodAffinityTerm
PodAffinityTerm
NodeAffinity
PreferredSchedulingTerm
Taint
TaintEffect
Toleration
TolerationOperator
PodSpec
PodSecurityContext
PodQOSClass
PodStatus
PodStatusResult
Pod
PodList
PodTemplateSpec
PodTemplate
PodTemplateList
ReplicationControllerSpec
ReplicationControllerStatus
ReplicationControllerConditionType
ReplicationControllerCondition
ReplicationController
ReplicationControllerList
ServiceAffinity
ServiceType
ServiceStatus
LoadBalancerStatus
LoadBalancerIngress
ServiceSpec
ServicePort
Service
ServiceList
ServiceAccount
ServiceAccountList
Endpoints
EndpointSubset
EndpointAddress
EndpointPort
EndpointsList
NodeSpec
DaemonEndpoint
NodeDaemonEndpoints
NodeSystemInfo
NodeStatus
UniqueVolumeName
AttachedVolume
AvoidPods
PreferAvoidPodsEntry
PodSignature
ContainerImage
NodePhase
NodeConditionType
NodeCondition
NodeAddressType
NodeAddress
ResourceName
ResourceList
Node
NodeList
FinalizerName
NamespaceSpec
NamespaceStatus
NamespacePhase
Namespace
NamespaceList
Binding
Preconditions
DeletionPropagation
DeleteOptions
ListOptions
PodLogOptions
PodAttachOptions
PodExecOptions
PodPortForwardOptions
PodProxyOptions
NodeProxyOptions
ServiceProxyOptions
ObjectReference
LocalObjectReference
SerializedReference
EventSource
Event
EventList
List
LimitType
LimitRangeItem
LimitRangeSpec
LimitRange
LimitRangeList
ResourceQuotaScope
ResourceQuotaSpec
ResourceQuotaStatus
ResourceQuota
ResourceQuotaList
Secret
SecretType
SecretList
ConfigMap
ConfigMapList
ComponentConditionType
ComponentCondition
ComponentStatus
ComponentStatusList
DownwardAPIVolumeSource
DownwardAPIVolumeFile
DownwardAPIProjection
SecurityContext
SELinuxOptions
RangeAllocation
Sysctl
NodeResources
SeccompPodAnnotationKey
SeccompContainerAnnotationKeyPrefix
PreferAvoidPodsAnnotationKey
SysctlsPodAnnotationKey
UnsafeSysctlsPodAnnotationKey
ObjectTTLAnnotationKey
AffinityAnnotationKey
PodInitContainersBetaAnnotationKey
PodInitContainersAnnotationKey
PodInitContainerStatusesBetaAnnotationKey
PodInitContainerStatusesAnnotationKey
ServiceAccountNameKey
ServiceAccountUIDKey
ServiceAccountTokenKey
ServiceAccountKubeconfigKey
ServiceAccountRootCAKey
ServiceAccountNamespaceKey
DockerConfigKey
DockerConfigJsonKey
BasicAuthUsernameKey
BasicAuthPasswordKey
SSHAuthPrivateKey
TLSCertKey
TLSPrivateKeyKey
AzureDataDiskCachingNone
AzureDataDiskCachingReadOnly
AzureDataDiskCachingReadWrite
BasicAuthPasswordKey
BasicAuthUsernameKey
BetaStorageClassAnnotation
ClaimBound
ClaimLost
ClaimPending
ClusterIPNone
ComponentHealthy
ConditionFalse
ConditionTrue
ConditionUnknown
ConfigMapVolumeSourceDefaultMode
DNSClusterFirst
DNSClusterFirstWithHostNet
DNSDefault
DefaultFailureDomains
DefaultHardPodAffinitySymmetricWeight
DefaultSchedulerName
DefaultTerminationGracePeriodSeconds
DeletePropagationBackground
DeletePropagationForeground
DeletePropagationOrphan
DockerConfigJsonKey
DockerConfigKey
DownwardAPIVolumeSourceDefaultMode
EventTypeNormal
EventTypeWarning
FinalizerKubernetes
LimitTypeContainer
LimitTypePersistentVolumeClaim
LimitTypePod
MaxSecretSize
NamespaceActive
NamespaceAll
NamespaceDefault
NamespaceTerminating
NodeDiskPressure
NodeExternalDNS
NodeExternalIP
NodeHostName
NodeInodePressure
NodeInternalDNS
NodeInternalIP
NodeLegacyHostIP
NodeMemoryPressure
NodeNetworkUnavailable
NodeOutOfDisk
NodePending
NodeReady
NodeRunning
NodeSelectorOpDoesNotExist
NodeSelectorOpExists
NodeSelectorOpGt
NodeSelectorOpIn
NodeSelectorOpLt
NodeSelectorOpNotIn
NodeTerminated
PersistentVolumeReclaimDelete
PersistentVolumeReclaimRecycle
PersistentVolumeReclaimRetain
PodFailed
PodInitContainerStatusesAnnotationKey
PodInitContainerStatusesBetaAnnotationKey
PodInitContainersAnnotationKey
PodInitContainersBetaAnnotationKey
PodInitialized
PodPending
PodQOSBestEffort
PodQOSBurstable
PodQOSGuaranteed
PodReady
PodReasonUnschedulable
PodRunning
PodScheduled
PodSucceeded
PodUnknown
ProjectedVolumeSourceDefaultMode
ProtocolTCP
ProtocolUDP
PullAlways
PullIfNotPresent
PullNever
ReadOnlyMany
ReadWriteMany
ReadWriteOnce
ReplicationControllerReplicaFailure
ResourceCPU
ResourceConfigMaps
ResourceLimitsCPU
ResourceLimitsMemory
ResourceMemory
ResourceNvidiaGPU
ResourceOpaqueIntPrefix
ResourcePersistentVolumeClaims
ResourcePods
ResourceQuotaScopeBestEffort
ResourceQuotaScopeNotBestEffort
ResourceQuotaScopeNotTerminating
ResourceQuotaScopeTerminating
ResourceQuotas
ResourceReplicationControllers
ResourceRequestsCPU
ResourceRequestsMemory
ResourceRequestsStorage
ResourceSecrets
ResourceServices
ResourceServicesLoadBalancers
ResourceServicesNodePorts
ResourceStorage
RestartPolicyAlways
RestartPolicyNever
RestartPolicyOnFailure
SSHAuthPrivateKey
SecretTypeBasicAuth
SecretTypeDockerConfigJson
SecretTypeDockercfg
SecretTypeOpaque
SecretTypeSSHAuth
SecretTypeServiceAccountToken
SecretTypeTLS
SecretVolumeSourceDefaultMode
ServiceAccountKubeconfigKey
ServiceAccountNameKey
ServiceAccountNamespaceKey
ServiceAccountRootCAKey
ServiceAccountTokenKey
ServiceAccountUIDKey
ServiceAffinityClientIP
ServiceAffinityNone
ServiceTypeClusterIP
ServiceTypeExternalName
ServiceTypeLoadBalancer
ServiceTypeNodePort
StorageMediumDefault
StorageMediumMemory
TLSCertKey
TLSPrivateKeyKey
TaintEffectNoExecute
TaintEffectNoSchedule
TaintEffectPreferNoSchedule
TerminationMessageFallbackToLogsOnError
TerminationMessagePathDefault
TerminationMessageReadFile
TolerationOpEqual
TolerationOpExists
URISchemeHTTP
URISchemeHTTPS
VolumeAvailable
VolumeBound
VolumeFailed
VolumePending
VolumeReleased
SetDefaults_ResourceList
SetDefaults_PodExecOptions
SetDefaults_PodAttachOptions
SetDefaults_ReplicationController
SetDefaults_Volume
SetDefaults_ContainerPort
SetDefaults_Container
SetDefaults_ServiceSpec
SetDefaults_Pod
SetDefaults_PodSpec
SetDefaults_Probe
SetDefaults_SecretVolumeSource
SetDefaults_ConfigMapVolumeSource
SetDefaults_DownwardAPIVolumeSource
SetDefaults_Secret
SetDefaults_ProjectedVolumeSource
SetDefaults_PersistentVolume
SetDefaults_PersistentVolumeClaim
SetDefaults_ISCSIVolumeSource
SetDefaults_AzureDiskVolumeSource
SetDefaults_Endpoints
SetDefaults_HTTPGetAction
SetDefaults_NamespaceStatus
SetDefaults_Node
SetDefaults_NodeStatus
SetDefaults_ObjectFieldSelector
SetDefaults_LimitRangeItem
SetDefaults_ConfigMap
defaultHostNetworkPorts
SetDefaults_RBDVolumeSource
SetDefaults_ScaleIOVolumeSource"

for t in $types; do
    # By placing the ']' as the first character immediately after the opening
    # bracket, it is interpreted as a member of the character set rather than a
    # closing bracket. Placing a '[' anywhere inside the brackets makes it a
    # member of the set.
    find ./ -maxdepth 1 -name "*.go" | xargs sed -i "s|\([][*(&[:space:]]\)$t\>|\1v1.$t|g"
done

old_import_path="\"k8s.io/kubernetes/pkg/api\""
new_import_path="\"k8s.io/api/core/v1\""
files=$(find ./ -maxdepth 1 -name "*.go")
for f in $files; do
    sed -i "s|import (|import (\n$new_import_path|g" $f
done

#exceptions
#sed -i "s|\"k8s.io/kubernetes/pkg/util/parsers\"|\"k8s.io/kubernetes/pkg/util/parsers\"\n$new_import_path|g" defaults.go
#sed -i "s|\"k8s.io/apimachinery/pkg/runtime\"|\"k8s.io/apimachinery/pkg/runtime\"\n$new_import_path|g" zz_generated.defaults.go
#find ./ -maxdepth 1 -name "*.go" | xargs sed -i "s/v1.v1.ObjectMeta/v1.ObjectMeta/g"
